
# 프로젝트 명 : 독거노인, 치매환자를 위한 모니터링 시스템
> 맡은 역할 : 라즈베리파이(홈 모니터링 시스템) 구현 및 통신

## <기기 구현 요구 사항 (라즈베리파이)>

- ~~아두이노 미니(스마트 밴드) 와 연동기능이 있다.~~
- 터치스크린에 날씨 알림.(GUI) 🔥
- 온도 습도 센서로 온,습도를 측정한다. 🔥 
  - 온도가 일정 이상일 때 관리자에게 열사병 주의 알림을 보낸다.
- 유해 가스 센서로 가스 누출여부를 확인한다.
  - 누출이 확인되면 알림을 보낸다.
- ~~위급상황시 누를 수 있는 물리적인 긴급 버튼이 있다.~~(-> 스마트 밴드)
  - ~~누르면 집의 주소가 119로 전달 된다.~~
  - ~~관리자와 보호자에게 긴급 문자 알림이 간다.~~
- 동작 감지 기능 (고독사 방지) 🔥
  - 사운드 센서, 인체 감지 센서(적외선) 를 사용하여 움직임을 감지하고, <br>
  3일 이상 감지 되지 않는다면 119, 관리자, 보호자에게 연락한다.
- CCTV 기능 🔥
  - pi카메라를 사용. 야간 적외선카메라모듈을 사용하여 밤에도 볼 수 있게 한다.
  - OpenCV 만약 밤에 움직임이 감지되면 부분을 녹화하여 서버로 보내준다.
- 음성인식 기능 
  - AI스피커 모드 : 구글 어시스턴드API등을 사용하여 사용자와 상호작용 할 수 있게 한다.
  
  
  ## <개발 환경> 
  ### HW 구성
  
  `필요 모듈`  <br>
  라즈베리파이 야간 적외선 카메라 모듈  <br>
  라즈베리파이 공식 7인치 터치스크린 + LCD 케이스 Black <br>
  DHT11 온습도센서 모듈 <br>
  MQ-135 아두이노 유해가스/공기질 센서 모듈 <br>
  ReSpeaker 2-Mics Pi HAT <br>
  소형 스테레오 스피커 Stereo Enclosed Speaker - 3W 8Ω  <br>
  ~~NEO-7M 아두이노 GPS 수신모듈~~ <br>
  ~~WIFI 모듈~~  <br>
  ~~블루투스 모듈~~  <br>
  
  ### MQTT 토픽 설정
  ```
  온도 : home/temp   
  습도 : home/humid   
  유해가스 : home/gas  
  움직임(밤): home/move  
  고독사 : home/alone 
  치매 동영상전송: home/vid
  ```
  
  ### HW 기능(제어 방법)
  
  ### SW 설계도 (흐름도 및 다이어 그램)

 ![](SW_flow.png)

  ### SW 기능 (알고리즘 설명) 
  
  ### 프로그램 사용법 (interface 시나리오)
  
  ### 개발 환경
   OS : Windows 10 , Linux Raspbian  <br>
   Tool : Visual Studio code, gcc , PyQt <br>
   Language : C, Python
  
  ## <개발 일정>
  내용 | 일정 
  ----|----
  온/습도 | 2020-06-09
  웹 서버 통신 | 2020-06-??
  디스플레이 화면 구성 |2020-06-10
  유해 가스 센서 | 2020-06-??
  적외선 카메라 |2020-06-15
  야간 움직임 감지(OpenCV)  | 2020-06-15 ~
  음성 인식 | 2020-06-15 ~ 
  
  ## <개발 진행도>
  _[06/08]_    <br>
  ✔  PyQt 사용해서 기본 GUI 화면구성   <br>
  ✔  아이콘 출력   <br>
  ✔  Qtimer이용한 실시간 시각 출력   <br>
  ❌  온습도 센서 받아서 값 화면에 띄우기   <br>
  ❌  쓰레드 사용하기    <br>
  
  _[06/09]_   <br>
   ✔  온습도 센서 받아서 값 화면에 띄우기   <br>
   ✔  QThread 사용하기 -> 날씨, 온/습도 <br>
   ✔  날씨를 크롤링 해서 보여주기 (날씨, 자외선, 미세먼지, 오존)  <br>
  
  _[06/10]_   <br>
   ✔  모듈 엑셀 파일로 정리해서 매니저님께 보내기   <br>
   ✔  QThread 사용 -> 날씨, 온/습도, 시계    <br>
   ❌  OpenCv <br>
   
   _[06/11]_   <br>
   ✔  카메라 모듈 공부 (어떻게 스트리밍 할지?) <br>
   ✔  카메라 외부 접속 설정하기 <br>
   ✔  재부팅시 프로그램 자동시작하기 <br>
   ✔  QThread 사용 -> 날씨, 온/습도, 시계, 카메라 <br>
   ❌  OpenCv 공부 <br>
   
   _[06/15]_   <br>
   ✔  MQTT -> webserver <br>
   ✔  센서값 -> thingspeak  <br>
   ✔  OpenCv 공부...  <br>
   
   _[06/16]_   <br>
   ✔  MQTT 토픽 설정 <br>
   ✔  OpenCv : 배경 지우기 <br>
   ✔  OpenCv : 노이즈 제거  <br>
   
   _[06/17]_   <br>
  ✔  OpenCv : 윤곽선 검출 <br>
  ✔  OpenCv : 얼굴 감지 <br>
  ✔  OpenCv : 움직임 포착시 텍스트 띄우기 <br>
  
   _[06/18]_   <br>
  ✔  OpenCv : 움직임 검출 + main.py <br>
  
   _[06/19]_   <br>
  ✔  OpenCv : 독거노인 고독사 방지 : 3일 이상 움직임 없으면 알림 (서버에 메시지 전송을 추가해야함 ) <br>
  
  _[06/22~24]_   <br>
  ✔  OpenCv : 야간 이상행동 감지 : 지정 시간에만 파일이 실행되고, 실행 된 후 행동을 감지하면 30초 동안 녹화된다. <br>
  
   _[06/25]_   <br>
  ✔  dem() 이름 포맷 변경, 파일 MQTT로 전송하기(txt는 성공, avi는 진행중)

   _[06/26]_   <br>
  ✔  동영상 MQTT 전송하기(Bas64 사용 인코딩, 디코딩)
  
  _[06/29]_   <br>
  ✔ 각각 알림을 MQTT 전송 <br>
  ✔ 새 터미널에서 .py 실행하기  <br>
  ✔ 적외선 카메라 조립 <br>
  ❌ 가스 모듈 조립(미 배송) <br>
  
   _[07/01]_   <br>
  ✔ 가스 모듈 조립 <br>
  ✔ 유해가스 감지시 알림 <br>
  
   _[07/02~04]_   <br>
  ✔ 구글 어시스턴트 API <br>
  
   _[07/05~07]_   <br>
  ✔ 구글 API와 main.ui버튼 연동 <br>
  
   _[07/08]_   <br>
  ✔  테스트 체크리스트 설계 <br>
  
